// ==UserScript==
// @name        yt-video-time-management
// @version     2.0.4
// @description extension for video time management
// @match       https://www.youtube.com/watch?*
// @icon        https://www.google.com/s2/favicons?sz=64&domain=youtube.com
// @grant       GM_setValue
// @grant       GM.setValue
// @grant       GM_getValue
// @grant       GM.getValue
// @grant       GM_deleteValue
// @grant       GM.deleteValue
// @grant       GM_listValues
// @grant       GM.listValues
// @grant       GM_setClipboard
// @grant       GM.setClipboard
// @grant       GM_addStyle
// @grant       GM.addStyle
// @grant       GM_addElement
// @grant       GM.addElement
// @grant       GM_addValueChangeListener
// @grant       GM.addValueChangeListener
// @grant       GM_removeValueChangeListener
// @grant       GM.removeValueChangeListener
// @grant       GM_registerMenuCommand
// @grant       GM.registerMenuCommand
// @grant       GM_unregisterMenuCommand
// @grant       GM.unregisterMenuCommand
// @grant       GM_download
// @grant       GM.download
// @grant       GM_getTab
// @grant       GM.getTab
// @grant       GM_getTabs
// @grant       GM.getTabs
// @grant       GM_saveTab
// @grant       GM.saveTab
// @grant       GM_openInTab
// @grant       GM.openInTab
// @grant       GM_notification
// @grant       GM.notification
// @grant       GM_getResourceURL
// @grant       GM.getResourceURL
// @grant       GM_getResourceText
// @grant       GM.getResourceText
// @grant       GM_xmlhttpRequest
// @grant       GM.xmlhttpRequest
// @grant       GM_log
// @grant       GM.log
// @grant       GM_info
// @grant       GM.info
// @grant       unsafeWindow
// @grant       window.onurlchange
// @grant       window.focus
// @grant       window.close
// ==/UserScript==

(function(){"use strict";const Nt=(t,e)=>t===e,A=Symbol("solid-proxy"),H=Symbol("solid-track"),M={equals:Nt};let it=pt;const $=1,q=2,lt={owned:null,cleanups:null,context:null,owner:null};var g=null;let K=null,m=null,b=null,T=null,z=0;function X(t,e){const n=m,r=g,o=t.length===0,i=o?lt:{owned:null,cleanups:null,context:null,owner:e===void 0?r:e},l=o?t:()=>t(()=>S(()=>U(i)));g=i,m=null;try{return j(l,!0)}finally{m=n,g=r}}function v(t,e){e=e?Object.assign({},M,e):M;const n={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},r=o=>(typeof o=="function"&&(o=o(n.value)),at(n,o));return[ut.bind(n),r]}function O(t,e,n){const r=Z(t,e,!1,$);E(r)}function B(t,e,n){it=qt;const r=Z(t,e,!1,$);(!n||!n.render)&&(r.user=!0),T?T.push(r):E(r)}function C(t,e,n){n=n?Object.assign({},M,n):M;const r=Z(t,e,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,E(r),ut.bind(r)}function D(t){return j(t,!1)}function S(t){if(m===null)return t();const e=m;m=null;try{return t()}finally{m=e}}function Y(t){B(()=>S(t))}function It(t){return g===null||(g.cleanups===null?g.cleanups=[t]:g.cleanups.push(t)),t}function ct(){return m}function ut(){if(this.sources&&this.state)if(this.state===$)E(this);else{const t=b;b=null,j(()=>R(this),!1),b=t}if(m){const t=this.observers?this.observers.length:0;m.sources?(m.sources.push(this),m.sourceSlots.push(t)):(m.sources=[this],m.sourceSlots=[t]),this.observers?(this.observers.push(m),this.observerSlots.push(m.sources.length-1)):(this.observers=[m],this.observerSlots=[m.sources.length-1])}return this.value}function at(t,e,n){let r=t.value;return(!t.comparator||!t.comparator(r,e))&&(t.value=e,t.observers&&t.observers.length&&j(()=>{for(let o=0;o<t.observers.length;o+=1){const i=t.observers[o],l=K&&K.running;l&&K.disposed.has(i),(l?!i.tState:!i.state)&&(i.pure?b.push(i):T.push(i),i.observers&&ft(i)),l||(i.state=$)}if(b.length>1e6)throw b=[],new Error},!1)),e}function E(t){if(!t.fn)return;U(t);const e=g,n=m,r=z;m=g=t,Lt(t,t.value,r),m=n,g=e}function Lt(t,e,n){let r;try{r=t.fn(e)}catch(o){return t.pure&&(t.state=$,t.owned&&t.owned.forEach(U),t.owned=null),t.updatedAt=n+1,dt(o)}(!t.updatedAt||t.updatedAt<=n)&&(t.updatedAt!=null&&"observers"in t?at(t,r):t.value=r,t.updatedAt=n)}function Z(t,e,n,r=$,o){const i={fn:t,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:g,context:null,pure:n};return g===null||g!==lt&&(g.owned?g.owned.push(i):g.owned=[i]),i}function V(t){if(t.state===0)return;if(t.state===q)return R(t);if(t.suspense&&S(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<z);)t.state&&e.push(t);for(let n=e.length-1;n>=0;n--)if(t=e[n],t.state===$)E(t);else if(t.state===q){const r=b;b=null,j(()=>R(t,e[0]),!1),b=r}}function j(t,e){if(b)return t();let n=!1;e||(b=[]),T?n=!0:T=[],z++;try{const r=t();return Mt(n),r}catch(r){n||(T=null),b=null,dt(r)}}function Mt(t){if(b&&(pt(b),b=null),t)return;const e=T;T=null,e.length&&j(()=>it(e),!1)}function pt(t){for(let e=0;e<t.length;e++)V(t[e])}function qt(t){let e,n=0;for(e=0;e<t.length;e++){const r=t[e];r.user?t[n++]=r:V(r)}for(e=0;e<n;e++)V(t[e])}function R(t,e){t.state=0;for(let n=0;n<t.sources.length;n+=1){const r=t.sources[n];if(r.sources){const o=r.state;o===$?r!==e&&(!r.updatedAt||r.updatedAt<z)&&V(r):o===q&&R(r,e)}}}function ft(t){for(let e=0;e<t.observers.length;e+=1){const n=t.observers[e];n.state||(n.state=q,n.pure?b.push(n):T.push(n),n.observers&&ft(n))}}function U(t){let e;if(t.sources)for(;t.sources.length;){const n=t.sources.pop(),r=t.sourceSlots.pop(),o=n.observers;if(o&&o.length){const i=o.pop(),l=n.observerSlots.pop();r<o.length&&(i.sourceSlots[l]=r,o[r]=i,n.observerSlots[r]=l)}}if(t.owned){for(e=t.owned.length-1;e>=0;e--)U(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0,t.context=null}function dt(t){throw t}const mt=Symbol("fallback");function ht(t){for(let e=0;e<t.length;e++)t[e]()}function zt(t,e,n={}){let r=[],o=[],i=[],l=[],s=0,c;return It(()=>ht(i)),()=>{const u=t()||[];return u[H],S(()=>{if(u.length===0)return s!==0&&(ht(i),i=[],r=[],o=[],s=0,l=[]),n.fallback&&(r=[mt],o[0]=X(f=>(i[0]=f,n.fallback())),s=1),o;for(r[0]===mt&&(i[0](),i=[],r=[],o=[],s=0),c=0;c<u.length;c++)c<r.length&&r[c]!==u[c]?l[c](()=>u[c]):c>=r.length&&(o[c]=X(a));for(;c<r.length;c++)i[c]();return s=l.length=i.length=u.length,r=u.slice(0),o=o.slice(0,s)});function a(f){i[c]=f;const[p,d]=v(u[c]);return l[c]=d,e(p,c)}}}function w(t,e){return S(()=>t(e||{}))}const Bt=t=>`Stale read from <${t}>.`;function gt(t){const e="fallback"in t&&{fallback:()=>t.fallback};return C(zt(()=>t.each,t.children,e||void 0))}function Dt(t){const e=t.keyed,n=C(()=>t.when,void 0,{equals:(r,o)=>e?r===o:!r==!o});return C(()=>{const r=n();if(r){const o=t.children;return typeof o=="function"&&o.length>0?S(()=>o(e?r:()=>{if(!S(n))throw Bt("Show");return t.when})):o}return t.fallback},void 0,void 0)}function Vt(t,e,n){let r=n.length,o=e.length,i=r,l=0,s=0,c=e[o-1].nextSibling,u=null;for(;l<o||s<i;){if(e[l]===n[s]){l++,s++;continue}for(;e[o-1]===n[i-1];)o--,i--;if(o===l){const a=i<r?s?n[s-1].nextSibling:n[i-s]:c;for(;s<i;)t.insertBefore(n[s++],a)}else if(i===s)for(;l<o;)(!u||!u.has(e[l]))&&e[l].remove(),l++;else if(e[l]===n[i-1]&&n[s]===e[o-1]){const a=e[--o].nextSibling;t.insertBefore(n[s++],e[l++].nextSibling),t.insertBefore(n[--i],a),e[o]=n[i]}else{if(!u){u=new Map;let f=s;for(;f<i;)u.set(n[f],f++)}const a=u.get(e[l]);if(a!=null)if(s<a&&a<i){let f=l,p=1,d;for(;++f<o&&f<i&&!((d=u.get(e[f]))==null||d!==a+p);)p++;if(p>a-s){const y=e[l];for(;s<a;)t.insertBefore(n[s++],y)}else t.replaceChild(n[s++],e[l++])}else l++;else e[l++].remove()}}}const bt="_$DX_DELEGATE";function Rt(t,e,n,r={}){let o;return X(i=>{o=i,e===document?t():_(e,t(),e.firstChild?null:void 0,n)},r.owner),()=>{o(),e.textContent=""}}function x(t,e,n){let r;const o=()=>{const l=document.createElement("template");return l.innerHTML=t,n?l.content.firstChild.firstChild:l.content.firstChild},i=e?()=>S(()=>document.importNode(r||(r=o()),!0)):()=>(r||(r=o())).cloneNode(!0);return i.cloneNode=i,i}function N(t,e=window.document){const n=e[bt]||(e[bt]=new Set);for(let r=0,o=t.length;r<o;r++){const i=t[r];n.has(i)||(n.add(i),e.addEventListener(i,Jt))}}function yt(t,e,n){n==null?t.removeAttribute(e):t.setAttribute(e,n)}function Ut(t,e){e==null?t.removeAttribute("class"):t.className=e}function Ft(t,e,n){return S(()=>t(e,n))}function _(t,e,n,r){if(n!==void 0&&!r&&(r=[]),typeof e!="function")return F(t,e,r,n);O(o=>F(t,e(),o,n),r)}function Jt(t){const e=`$$${t.type}`;let n=t.composedPath&&t.composedPath()[0]||t.target;for(t.target!==n&&Object.defineProperty(t,"target",{configurable:!0,value:n}),Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return n||document}});n;){const r=n[e];if(r&&!n.disabled){const o=n[`${e}Data`];if(o!==void 0?r.call(n,o,t):r.call(n,t),t.cancelBubble)return}n=n._$host||n.parentNode||n.host}}function F(t,e,n,r,o){for(;typeof n=="function";)n=n();if(e===n)return n;const i=typeof e,l=r!==void 0;if(t=l&&n[0]&&n[0].parentNode||t,i==="string"||i==="number")if(i==="number"&&(e=e.toString()),l){let s=n[0];s&&s.nodeType===3?s.data=e:s=document.createTextNode(e),n=P(t,n,r,s)}else n!==""&&typeof n=="string"?n=t.firstChild.data=e:n=t.textContent=e;else if(e==null||i==="boolean")n=P(t,n,r);else{if(i==="function")return O(()=>{let s=e();for(;typeof s=="function";)s=s();n=F(t,s,n,r)}),()=>n;if(Array.isArray(e)){const s=[],c=n&&Array.isArray(n);if(Q(s,e,n,o))return O(()=>n=F(t,s,n,r,!0)),()=>n;if(s.length===0){if(n=P(t,n,r),l)return n}else c?n.length===0?vt(t,s,r):Vt(t,n,s):(n&&P(t),vt(t,s));n=s}else if(e.nodeType){if(Array.isArray(n)){if(l)return n=P(t,n,r,e);P(t,n,null,e)}else n==null||n===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);n=e}else console.warn("Unrecognized value. Skipped inserting",e)}return n}function Q(t,e,n,r){let o=!1;for(let i=0,l=e.length;i<l;i++){let s=e[i],c=n&&n[i],u;if(!(s==null||s===!0||s===!1))if((u=typeof s)=="object"&&s.nodeType)t.push(s);else if(Array.isArray(s))o=Q(t,s,c)||o;else if(u==="function")if(r){for(;typeof s=="function";)s=s();o=Q(t,Array.isArray(s)?s:[s],Array.isArray(c)?c:[c])||o}else t.push(s),o=!0;else{const a=String(s);c&&c.nodeType===3&&c.data===a?t.push(c):t.push(document.createTextNode(a))}}return o}function vt(t,e,n=null){for(let r=0,o=e.length;r<o;r++)t.insertBefore(e[r],n)}function P(t,e,n,r){if(n===void 0)return t.textContent="";const o=r||document.createTextNode("");if(e.length){let i=!1;for(let l=e.length-1;l>=0;l--){const s=e[l];if(o!==s){const c=s.parentNode===t;!i&&!l?c?t.replaceChild(o,s):t.insertBefore(o,n):c&&s.remove()}else i=!0}}else t.insertBefore(o,n);return[o]}const W=Symbol("store-raw"),I=Symbol("store-node");function wt(t){let e;return t!=null&&typeof t=="object"&&(t[A]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function J(t,e=new Set){let n,r,o,i;if(n=t!=null&&t[W])return n;if(!wt(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let l=0,s=t.length;l<s;l++)o=t[l],(r=J(o,e))!==o&&(t[l]=r)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const l=Object.keys(t),s=Object.getOwnPropertyDescriptors(t);for(let c=0,u=l.length;c<u;c++)i=l[c],!s[i].get&&(o=t[i],(r=J(o,e))!==o&&(t[i]=r))}return t}function tt(t){let e=t[I];return e||Object.defineProperty(t,I,{value:e=Object.create(null)}),e}function et(t,e,n){return t[e]||(t[e]=kt(n))}function xt(t){if(ct()){const e=tt(t);(e._||(e._=kt()))()}}function Gt(t){return xt(t),Reflect.ownKeys(t)}function kt(t){const[e,n]=v(t,{equals:!1,internal:!0});return e.$=n,e}function _t(t,e,n,r=!1){if(!r&&t[e]===n)return;const o=t[e],i=t.length;n===void 0?delete t[e]:t[e]=n;let l=tt(t),s;if((s=et(l,e,o))&&s.$(()=>n),Array.isArray(t)&&t.length!==i){for(let c=t.length;c<i;c++)(s=l[c])&&s.$();(s=et(l,"length",i))&&s.$(t.length)}(s=l._)&&s.$()}function Ht(t,e){const n=Reflect.getOwnPropertyDescriptor(t,e);return!n||n.get||n.set||!n.configurable||e===A||e===I||(delete n.value,delete n.writable,n.get=()=>t[A][e],n.set=r=>t[A][e]=r),n}const Kt={get(t,e,n){if(e===W)return t;if(e===A)return n;if(e===H)return xt(t),n;const r=tt(t),o=r[e];let i=o?o():t[e];if(e===I||e==="__proto__")return i;if(!o){const l=Object.getOwnPropertyDescriptor(t,e),s=typeof i=="function";if(ct()&&(!s||t.hasOwnProperty(e))&&!(l&&l.get))i=et(r,e,i)();else if(i!=null&&s&&i===Array.prototype[e])return(...c)=>D(()=>Array.prototype[e].apply(n,c))}return wt(i)?Tt(i):i},has(t,e){return e===W||e===A||e===H||e===I||e==="__proto__"?!0:(this.get(t,e,t),e in t)},set(t,e,n){return D(()=>_t(t,e,J(n))),!0},deleteProperty(t,e){return D(()=>_t(t,e,void 0,!0)),!0},ownKeys:Gt,getOwnPropertyDescriptor:Ht};function Tt(t){let e=t[A];if(!e){Object.defineProperty(t,A,{value:e=new Proxy(t,Kt)});const n=Object.keys(t),r=Object.getOwnPropertyDescriptors(t);for(let o=0,i=n.length;o<i;o++){const l=n[o];if(r[l].get){const s=r[l].get.bind(e);Object.defineProperty(t,l,{get:s})}if(r[l].set){const s=r[l].set;Object.defineProperty(t,l,{set:c=>D(()=>s.call(e,c))})}}}return e}function Xt(t,e){const n=J(t||{});return Tt(n)}const Yt=t=>{let e=window.location.href;t({url:e}),navigation.addEventListener("navigate",n=>{e!==n.destination.url&&(e=n.destination.url,t({url:e}))})},Zt=x('<div class="switcher"><input type="checkbox" style="display:none"><label class="toggle"><span>'),St=t=>{const e=crypto.randomUUID();return(()=>{const n=Zt(),r=n.firstChild,o=r.nextSibling;return r.addEventListener("change",()=>t.setState(!t.state)),yt(r,"id",e),yt(o,"for",e),O(()=>r.checked=!t.state),n})()},Qt=x('<div class="content__time"><div> </div><div>min</div><input type="number" min="0" max="60" maxlength="2"><div>sec</div><input type="number" min="0" max="60" maxlength="2">'),At=t=>{const[e,n]=v(Math.floor(t.time/60)),[r,o]=v(t.time%60);return t.ref({allTime:()=>e()*60+r(),min:e,sec:r,setMin:n,setSec:o}),Y(()=>{n(Math.floor(t.time/60)),o(t.time%60)}),(()=>{const i=Qt(),l=i.firstChild,s=l.firstChild,c=l.nextSibling,u=c.nextSibling,a=u.nextSibling,f=a.nextSibling;return _(l,()=>t.title,s),u.$$input=p=>n(Number(p.target.value)),f.$$input=p=>o(Number(p.target.value)),O(()=>u.value=e()),O(()=>f.value=r()),i})()};N(["input"]);const Wt=x('<div class="content__wrapper__time">'),$t=t=>{let e,n;const r=()=>{!e||!n||(n.allTime()<e.allTime()&&n.setSec(e.sec()),n.allTime()<e.allTime()&&n.setMin(e.min()))};return Y(()=>{!e||!n||t.ref({startTime:e.allTime,endTime:n.allTime,checkInputsValues:r,clearValues:()=>{!e||!n||(e.setMin(0),e.setSec(0),n.setMin(0),n.setSec(0))}})}),(()=>{const o=Wt();return _(o,w(At,{title:"start",get time(){return t.time.start},ref:i=>e=i}),null),_(o,w(At,{title:"end",get time(){return t.time.end},ref:i=>n=i}),null),o})()},nt=t=>{let[e,n,r]=t.split(":").map(Number);return r===void 0&&(r=n,n=e,e=0),e*3600+n*60+r},te=x('<div><div>loop</div><div>mode </div><div class="chapters">'),ee=x('<div class="chapter"><span>'),ne=t=>{const[e,n]=v(),[r,o]=v(!1);B(()=>{const c=e();if(c){const u=t.player();t.ref({checkInputsValues:c.checkInputsValues,startTime:c.startTime,endTime:c.endTime,apply:(a,f)=>{if(!u)return;const p=u.getCurrentTime();f!==0&&(p>=f||p<a)&&u.seekTo(a)}});return}});const[i,l]=v(null),s=(c,u)=>{const a=nt(c),f=nt(t.chapters()[u+1]);h.loopTime={start:a,end:f},l(u)};return(()=>{const c=te(),u=c.firstChild,a=u.nextSibling;a.firstChild;const f=a.nextSibling;return c.style.setProperty("text-align","center"),_(c,w(St,{get state(){return r()},setState:o}),a),_(a,()=>r()?"input":"select",null),_(f,(()=>{const p=C(()=>!!r());return()=>p()?w($t,{ref:n,get time(){return h.loopTime}}):w(gt,{get each(){return t.chapters()},children:(d,y)=>(()=>{const k=ee(),L=k.firstChild;return L.$$click=()=>s(d(),y),_(L,d),O(()=>L.classList.toggle("active",i()===y)),k})()})})()),c})()};N(["click"]);const re=x("<div>skip"),oe=x('<button class="btn mt-8">add'),se=x('<button class="btn mt-8">remove'),ie=x('<button class="btn mt-8">clear'),le=t=>{const[e,n]=v([]);B(()=>{if(e().length){const l=t.player();t.ref({checkInputsValues:()=>e().forEach(s=>s.checkInputsValues()),startTime:e().map(s=>s.startTime),endTime:e().map(s=>s.endTime),apply:s=>{if(!l)return;const c=l.getCurrentTime();s.forEach(u=>{u.end!==0&&c>=u.start&&c<u.end&&l.seekTo(u.end)})}})}});const r=()=>{h.skipTime.push({start:0,end:0})},o=()=>{h.skipTime.length!==1&&(h.skipTime.splice(-1),n([...e()].splice(-1)))},i=()=>{h.skipTime=h.skipTime.map(()=>({start:0,end:0})),e().forEach(l=>l.clearValues())};return[(()=>{const l=re();return l.style.setProperty("text-align","center"),l})(),w(gt,{get each(){return h.skipTime},children:(l,s)=>w($t,{ref:c=>n([...e(),c]),get time(){return h.skipTime[s]}})}),(()=>{const l=oe();return l.$$click=r,l})(),(()=>{const l=se();return l.$$click=o,l})(),(()=>{const l=ie();return l.$$click=i,l})()]};N(["click"]);const ce=x('<button class="btn mt-8">apply'),ue=x('<button class="btn mt-8">cancel'),ae=({chapters:t})=>{const[e,n]=v(!0),r=document.querySelector("#ytd-player");let[o,i]=v(null),l,s;Y(()=>{setTimeout(()=>{r&&i(r.getPlayer())},500)});const c=()=>{const p=localStorage.getItem("yt-time");let d=JSON.parse(p||"[]");const y=new URLSearchParams(window.location.search).get("v");y&&(d.some(k=>k.id===y)?d=d.map(k=>k.id===y?{...k,time:h}:k):d=[...d,{id:y,time:h}],localStorage.setItem("yt-time",JSON.stringify(d)))},u=()=>{const p=l?.startTime()||0,d=l?.endTime()||0,y=[];return l&&(l.checkInputsValues(),h.loopTime={start:p,end:d}),s&&(s.checkInputsValues(),s.startTime.forEach((k,L)=>{const Et=s?.endTime[L]();Et!==void 0&&y.push({start:k(),end:Et})}),h.skipTime=y),c(),{loopTimeStart:p,loopTimeEnd:d,skipTime:y}},a=()=>{if(!o())return;const p=e(),{loopTimeStart:d,loopTimeEnd:y,skipTime:k}=u();console.log(d,y,k),clearInterval(rt()),ot(setInterval(()=>{p?l?.apply(h.loopTime.start,h.loopTime.end):s?.apply(k)},1e3))},f=()=>{clearInterval(rt()),ot(0)};return[w(St,{get state(){return e()},setState:p=>{u(),n(p)}}),C((()=>{const p=C(()=>!!e());return()=>p()?w(ne,{ref:d=>l=d,player:o,chapters:t}):w(le,{ref:d=>s=d,player:o})})()),(()=>{const p=ce();return p.$$click=a,p})(),(()=>{const p=ue();return p.$$click=f,p})()]};N(["click"]);const pe=t=>{var e;const n=/(\d{0,2}:?\d{1,2}:\d{2})/g;return(e=t.match(n))==null?void 0:e[0]},fe=t=>{const e=t.split(`
`),n=[];let r=0;for(let o=0;o<e.length;o++){const i=e[o],l=pe(i);if(!l)continue;const s=i.split(" ").filter(u=>!u.includes(l)).join(" "),c=nt(l);if(c<r)break;r=c,n.push({timestamp:l,title:s})}return n},de=x("<div>"),me=x('<div class="menu__root"><svg class="settings" xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16"><path d="M9.405 1.05c-.413-1.4-2.397-1.4-2.81 0l-.1.34a1.464 1.464 0 0 1-2.105.872l-.31-.17c-1.283-.698-2.686.705-1.987 1.987l.169.311c.446.82.023 1.841-.872 2.105l-.34.1c-1.4.413-1.4 2.397 0 2.81l.34.1a1.464 1.464 0 0 1 .872 2.105l-.17.31c-.698 1.283.705 2.686 1.987 1.987l.311-.169a1.464 1.464 0 0 1 2.105.872l.1.34c.413 1.4 2.397 1.4 2.81 0l.1-.34a1.464 1.464 0 0 1 2.105-.872l.31.17c1.283.698 2.686-.705 1.987-1.987l-.169-.311a1.464 1.464 0 0 1 .872-2.105l.34-.1c1.4-.413 1.4-2.397 0-2.81l-.34-.1a1.464 1.464 0 0 1-.872-2.105l.17-.31c.698-1.283-.705-2.686-1.987-1.987l-.311.169a1.464 1.464 0 0 1-2.105-.872l-.1-.34zM8 10.93a2.929 2.929 0 1 1 0-5.86 2.929 2.929 0 0 1 0 5.858z">'),[rt,ot]=v(0),[st,Ot]=v(!1),[he,Ct]=v("open");let G=null;const h=Xt({loopTime:{start:0,end:0},skipTime:[{start:0,end:0}]});Yt(async({url:t})=>{clearInterval(rt()),ot(0),h.loopTime={start:0,end:0},h.skipTime=[{start:0,end:0}],Ot(!1);const e=t.split("?")[1],n=new URLSearchParams(e).get("v"),r=localStorage.getItem("yt-time");if(r){const o=JSON.parse(r).find(i=>i.id===n);if(o){const{loopTime:i,skipTime:l}=o.time;h.loopTime=i,h.skipTime=l}}});const[jt,ge]=v([]),be=()=>{const t=()=>{var n;jt().length||((n=document.querySelector("#description  #expand"))==null||n.click(),requestAnimationFrame(()=>{var r,o;const i=(o=(r=document.querySelector("#bottom-row"))==null?void 0:r.querySelector("#description"))==null?void 0:o.textContent,l=fe(i??"");l&&ge(l.map(s=>s.timestamp))})),Ct("close"),setTimeout(()=>{Ot(!st()),Ct("open")},100)},e=n=>{G&&!n.composedPath().includes(G)&&t()};return B(()=>{st()?window.addEventListener("mousedown",e):window.removeEventListener("mousedown",e)}),(()=>{const n=me(),r=n.firstChild,o=G;return typeof o=="function"?Ft(o,n):G=n,r.$$click=t,_(n,w(Dt,{get when(){return st()},get children(){const i=de();return _(i,w(ae,{chapters:jt})),O(()=>Ut(i,`content ${he()}`)),i}}),null),n})()};N(["click"]);function ye(t,e,n){const r=new MutationObserver((o,i)=>{for(const l of o)e(l,i)});return r.observe(t,{childList:!0,subtree:!0,...n}),()=>r.disconnect()}function Pt({selector:t,target:e=document.body,rejectTimeoutMs:n,signal:r}){return new Promise((o,i)=>{const l=ye(e,(u,a)=>{const f=e.querySelector(t);f&&(a.disconnect(),o(f))}),s={timeout:null,abort:null},c=u=>{s.timeout&&clearTimeout(s.timeout),s.abort&&r.removeEventListener("abort",s.abort),l(),i(u)};n>0&&(s.timeout=setTimeout(()=>c(`${Pt.name} rejected (${n}ms)`),n)),r&&!r.aborted&&(s.abort=()=>c(r.reason),r.addEventListener("abort",s.abort))})}const ve=`#owner .menu__root{position:relative;margin-left:10px}#owner .menu__root .settings{cursor:pointer;transition:.3s;user-select:none}#owner .menu__root .settings:hover{transform:rotate(180deg) scale(1.1)}#owner .menu__root .content{position:absolute;top:0;left:30px;background:#1c1c1c;border-radius:8px;width:240px;max-height:290px;z-index:100;animation:menuOpen .2s;padding:12px 4px 12px 12px;scrollbar-gutter:stable;box-sizing:border-box;font-size:14px;overflow:auto}#owner .menu__root .content.close{animation:menuClose .1s;opacity:0;transition:opacity .1s}#owner .menu__root .content::-webkit-scrollbar{width:8px}#owner .menu__root .content::-webkit-scrollbar-track{background-color:#1c1c1c;border-radius:0 0 8px}#owner .menu__root .content::-webkit-scrollbar-thumb{background:#7b7b7b;border-radius:10px;transform:scaleY(-1)}#owner .menu__root .content .content__wrapper__time{margin-bottom:6px}#owner .menu__root .content .content__wrapper__time .content__time{display:grid;grid-template-columns:60px auto 1fr auto 1fr;align-items:center;gap:4px}#owner .menu__root .content .content__wrapper__time .content__time .loop{display:flex;gap:4px;align-items:center}#owner .menu__root .content input{margin:4px 0;border:none;border-radius:4px;background:#363636;color:#fff;outline:none;width:24px;text-align:center}#owner .menu__root .content input::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}#owner .menu__root .content hr{all:revert}#owner .menu__root .content .chapters{display:grid;grid-template-columns:1fr 1fr;gap:4px}#owner .menu__root .content .chapters .chapter span{cursor:pointer;transition:.3s;position:relative}#owner .menu__root .content .chapters .chapter span:hover:not(.active):after{position:absolute;content:"";bottom:0;left:0;width:100%;height:1px;background:#fff}#owner .menu__root .content .chapters .chapter span.active{background:#464646;border-radius:6px;padding:4px}@keyframes menuOpen{0%{opacity:.6;transform:scale(0)}to{opacity:1;transform:scale(1)}}@keyframes menuClose{0%{opacity:1;transform:scale(1)}to{opacity:.6;transform:scale(0)}}.mb-6{margin-bottom:6px}.mt-8{margin-top:6px}.btn{font-family:Roboto;font-size:16px;cursor:pointer;border-radius:10px;outline:none;color:#1c1c1c;background:#363636;padding:2px 6px 1px;transition:.4s;border:2px solid #363636;width:100%;color:#fff}.btn:hover{background:#1c1c1c}.switcher{display:flex;justify-content:center;margin-bottom:6px}.switcher .toggle{position:relative;display:block;width:40px;height:20px;cursor:pointer;-webkit-tap-highlight-color:transparent;transform:translateZ(0)}.switcher .toggle:before{content:"";position:relative;top:3px;left:3px;width:34px;height:14px;display:block;background:#9A9999;border-radius:8px;transition:background .2s linear}.switcher .toggle span{position:absolute;top:0;left:0;width:20px;height:20px;display:block;background:white;border-radius:10px;box-shadow:0 3px 8px #9a999980;transition:all .2s linear}.switcher #cbx:checked+.toggle span{background:#fff;transform:translate(20px);transition:all .2s cubic-bezier(.8,.4,.3,1.25) linear;box-shadow:0 3px 8px #fff3}
`;GM_addStyle(ve),window.trustedTypes.createPolicy("default",{createHTML:t=>t}),Pt({selector:"#owner"}).then(t=>{Rt(()=>w(be,{}),t)})})();
