var ce=Object.defineProperty,le=(g,f,_)=>f in g?ce(g,f,{enumerable:!0,configurable:!0,writable:!0,value:_}):g[f]=_,E=(g,f,_)=>(le(g,typeof f!="symbol"?f+"":f,_),_);(function(){"use strict";function g(t,e){var n=f(t),o=n.tag,r=n.id,i=n.className,a=e?document.createElementNS(e,o):document.createElement(o);return r&&(a.id=r),i&&(e?a.setAttribute("class",i):a.className=i),a}function f(t){for(var e=t.split(/([.#])/),n="",o="",r=1;r<e.length;r+=2)switch(e[r]){case".":n+=" "+e[r+1];break;case"#":o=e[r+1]}return{className:n.trim(),tag:e[0]||"div",id:o}}function _(t,e){var n=d(t),o=d(e);return e===o&&o.__redom_view&&(e=o.__redom_view),o.parentNode&&(T(e,o,n),n.removeChild(o)),e}function T(t,e,n){var o=e.__redom_lifecycle;if(A(o)){e.__redom_lifecycle={};return}var r=n;for(e.__redom_mounted&&b(e,"onunmount");r;){var i=r.__redom_lifecycle||{};for(var a in o)i[a]&&(i[a]-=o[a]);A(i)&&(r.__redom_lifecycle=null),r=r.parentNode}}function A(t){if(t==null)return!0;for(var e in t)if(t[e])return!1;return!0}var $=["onmount","onremount","onunmount"],K=typeof window<"u"&&"ShadowRoot"in window;function v(t,e,n,o){var r=d(t),i=d(e);e===i&&i.__redom_view&&(e=i.__redom_view),e!==i&&(i.__redom_view=e);var a=i.__redom_mounted,u=i.parentNode;if(a&&u!==r&&T(e,i,u),n!=null)if(o){var s=d(n);s.__redom_mounted&&b(s,"onunmount"),r.replaceChild(i,s)}else r.insertBefore(i,d(n));else r.appendChild(i);return ee(e,i,r,u),e}function b(t,e){e==="onmount"||e==="onremount"?t.__redom_mounted=!0:e==="onunmount"&&(t.__redom_mounted=!1);var n=t.__redom_lifecycle;if(n){var o=t.__redom_view,r=0;o&&o[e]&&o[e]();for(var i in n)i&&r++;if(r)for(var a=t.firstChild;a;){var u=a.nextSibling;b(a,e),a=u}}}function ee(t,e,n,o){for(var r=e.__redom_lifecycle||(e.__redom_lifecycle={}),i=n===o,a=!1,u=0,s=$;u<s.length;u+=1){var c=s[u];i||t!==e&&c in t&&(r[c]=(r[c]||0)+1),r[c]&&(a=!0)}if(!a){e.__redom_lifecycle={};return}var l=n,S=!1;for((i||l&&l.__redom_mounted)&&(b(e,i?"onremount":"onmount"),S=!0);l;){var C=l.parentNode,X=l.__redom_lifecycle||(l.__redom_lifecycle={});for(var D in r)X[D]=(X[D]||0)+r[D];if(S)break;(l.nodeType===Node.DOCUMENT_NODE||K&&l instanceof ShadowRoot||C&&C.__redom_mounted)&&(b(l,i?"onremount":"onmount"),S=!0),l=C}}function te(t,e,n){var o=d(t);if(typeof e=="object")for(var r in e)O(o,r,e[r]);else O(o,e,n)}function O(t,e,n){t.style[e]=n??""}var z="http://www.w3.org/1999/xlink";function Y(t,e,n,o){var r=d(t),i=typeof e=="object";if(i)for(var a in e)Y(r,a,e[a],o);else{var u=r instanceof SVGElement,s=typeof n=="function";if(e==="style"&&typeof n=="object")te(r,n);else if(u&&s)r[e]=n;else if(e==="dataset")P(r,n);else if(!u&&(e in r||s)&&e!=="list")r[e]=n;else{if(u&&e==="xlink"){Q(r,n);return}o&&e==="class"&&(n=r.className+" "+n),n==null?r.removeAttribute(e):r.setAttribute(e,n)}}}function Q(t,e,n){if(typeof e=="object")for(var o in e)Q(t,o,e[o]);else n!=null?t.setAttributeNS(z,e,n):t.removeAttributeNS(z,e,n)}function P(t,e,n){if(typeof e=="object")for(var o in e)P(t,o,e[o]);else n!=null?t.dataset[e]=n:delete t.dataset[e]}function ne(t){return document.createTextNode(t??"")}function V(t,e,n){for(var o=0,r=e;o<r.length;o+=1){var i=r[o];if(!(i!==0&&!i)){var a=typeof i;a==="function"?i(t):a==="string"||a==="number"?t.appendChild(ne(i)):G(d(i))?v(t,i):i.length?V(t,i,n):a==="object"&&Y(t,i,null,n)}}}function d(t){return t.nodeType&&t||!t.el&&t||d(t.el)}function G(t){return t&&t.nodeType}function w(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];var o,r=typeof t;if(r==="string")o=g(t);else if(r==="function"){var i=t;o=new(Function.prototype.bind.apply(i,[null].concat(e)))}else throw new Error("At least one argument required");return V(d(o),e,!0),o}var m=w;w.extend=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return w.bind.apply(w,[this].concat(t))};function k(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];for(var o=d(t),r=W(t,e,o.firstChild);r;){var i=r.nextSibling;_(t,r),r=i}}function W(t,e,n){for(var o=n,r=Array(e.length),i=0;i<e.length;i++)r[i]=e[i]&&d(e[i]);for(var a=0;a<e.length;a++){var u=e[a];if(u){var s=r[a];if(s===o){o=o.nextSibling;continue}if(G(s)){var c=o&&o.nextSibling,l=u.__redom_index!=null,S=l&&c===r[a+1];v(t,u,o,S),S&&(o=c);continue}u.length!=null&&(o=W(t,u,o))}}return o}class p{constructor(e){E(this,"el"),this.el=m("input",{className:e??"",type:"number",value:"00",min:0,max:60,maxlength:2})}}class x{constructor(e,n,o){E(this,"el"),this.el=m("div",{className:"content__time"}),k(this.el,[m("div",e+":"),m("div","min."),n,m("div","sec."),o])}}class j{constructor({inputsSkipTime:e,inputsLoopTime:n}){E(this,"el"),this.el=m("div",{className:"content__wrapper__time"});let o,r;e&&(o=new x("start",e.inputSkipStartMin,e.inputSkipStartSec),r=new x("end",e.inputSkipEndMin,e.inputSkipEndSec)),n&&(o=new x("start",n.inputLoopStartMin,n.inputLoopStartSec),r=new x("end",n.inputLoopEndMin,n.inputLoopEndSec)),k(this.el,[o,r])}}function B(t){return new Promise(e=>{if(document.querySelector(t))return e(document.querySelector(t));const n=new MutationObserver(o=>{document.querySelector(t)&&(e(document.querySelector(t)),n.disconnect())});n.observe(document.body,{childList:!0,subtree:!0})})}const oe=(t,e)=>{const n=new DOMParser().parseFromString(atob(t.replace(/data:image\/svg\+xml;base64,/,"")),"image/svg+xml").querySelector("svg");return e&&n.classList.add(e),n},re="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0iY3VycmVudENvbG9yIiBjbGFzcz0iYmkgYmktZ2Vhci1maWxsIiB2aWV3Qm94PSIwIDAgMTYgMTYiPg0KICA8cGF0aCBkPSJNOS40MDUgMS4wNWMtLjQxMy0xLjQtMi4zOTctMS40LTIuODEgMGwtLjEuMzRhMS40NjQgMS40NjQgMCAwIDEtMi4xMDUuODcybC0uMzEtLjE3Yy0xLjI4My0uNjk4LTIuNjg2LjcwNS0xLjk4NyAxLjk4N2wuMTY5LjMxMWMuNDQ2LjgyLjAyMyAxLjg0MS0uODcyIDIuMTA1bC0uMzQuMWMtMS40LjQxMy0xLjQgMi4zOTcgMCAyLjgxbC4zNC4xYTEuNDY0IDEuNDY0IDAgMCAxIC44NzIgMi4xMDVsLS4xNy4zMWMtLjY5OCAxLjI4My43MDUgMi42ODYgMS45ODcgMS45ODdsLjMxMS0uMTY5YTEuNDY0IDEuNDY0IDAgMCAxIDIuMTA1Ljg3MmwuMS4zNGMuNDEzIDEuNCAyLjM5NyAxLjQgMi44MSAwbC4xLS4zNGExLjQ2NCAxLjQ2NCAwIDAgMSAyLjEwNS0uODcybC4zMS4xN2MxLjI4My42OTggMi42ODYtLjcwNSAxLjk4Ny0xLjk4N2wtLjE2OS0uMzExYTEuNDY0IDEuNDY0IDAgMCAxIC44NzItMi4xMDVsLjM0LS4xYzEuNC0uNDEzIDEuNC0yLjM5NyAwLTIuODFsLS4zNC0uMWExLjQ2NCAxLjQ2NCAwIDAgMS0uODcyLTIuMTA1bC4xNy0uMzFjLjY5OC0xLjI4My0uNzA1LTIuNjg2LTEuOTg3LTEuOTg3bC0uMzExLjE2OWExLjQ2NCAxLjQ2NCAwIDAgMS0yLjEwNS0uODcybC0uMS0uMzR6TTggMTAuOTNhMi45MjkgMi45MjkgMCAxIDEgMC01Ljg2IDIuOTI5IDIuOTI5IDAgMCAxIDAgNS44NTh6Ii8+DQo8L3N2Zz4=";var M=(t=>(t[t.Ended=0]="Ended",t[t.Playing=1]="Playing",t[t.Paused=2]="Paused",t[t.Buffering=3]="Buffering",t[t.VideoCued=4]="VideoCued",t))(M||{});const ie=`#owner .menu__root{position:relative;margin-left:10px}#owner .menu__root .settings{cursor:pointer;transition:.3s;user-select:none}#owner .menu__root .settings:hover{transform:rotate(180deg) scale(1.1)}#owner .menu__root .content{position:absolute;top:0;left:30px;background:#1c1c1c;border-radius:8px;width:240px;height:290px;z-index:100;animation:menuOpen .2s;padding:12px;box-sizing:border-box;font-size:14px;overflow:auto}#owner .menu__root .content.close{animation:menuClose .1s}#owner .menu__root .content::-webkit-scrollbar{width:8px}#owner .menu__root .content::-webkit-scrollbar-track{background-color:#1c1c1c;border-radius:0 0 8px}#owner .menu__root .content::-webkit-scrollbar-thumb{background:#7b7b7b;border-radius:10px;transform:scaleY(-1)}#owner .menu__root .content .content__wrapper__time{margin-bottom:6px}#owner .menu__root .content .content__wrapper__time .content__time{display:grid;grid-template-columns:60px auto 1fr auto 1fr;align-items:center;gap:4px}#owner .menu__root .content .content__wrapper__time .content__time .loop{display:flex;gap:4px;align-items:center}#owner .menu__root .content input{margin:4px 0;border:none;border-radius:4px;background:#363636;color:#fff;outline:none;width:24px;text-align:center}#owner .menu__root .content input::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}#owner .menu__root .content hr{all:revert}@keyframes menuOpen{0%{opacity:.6;transform:scale(0)}to{opacity:1;transform:scale(1)}}@keyframes menuClose{0%{opacity:1;transform:scale(1)}to{opacity:.6;transform:scale(0)}}.mb-6{margin-bottom:6px}.mt-8{margin-top:6px}.btn{font-family:Roboto;font-size:16px;cursor:pointer;border-radius:10px;outline:none;color:#1c1c1c;background:#363636;padding:2px 6px 1px;transition:.4s;border:2px solid #363636;width:100%;color:#fff}.btn:hover{background:#1c1c1c}
`;GM_addStyle(ie);const N=m("div",{className:"menu__root"}),R=new p().el,q=new p().el,F=new p().el,Z=new p().el,y=m("div",{className:"content"}),L=[{inputSkipStartMin:new p().el,inputSkipStartSec:new p().el,inputSkipEndMin:new p().el,inputSkipEndSec:new p().el}],h=m("div",{className:"content__skip"});v(h,new j({inputsSkipTime:L[0]}));const ae=m("button","add time skip",{className:"btn mt-8",onclick:()=>{L.push({inputSkipStartMin:new p().el,inputSkipStartSec:new p().el,inputSkipEndMin:new p().el,inputSkipEndSec:new p().el}),v(h,new j({inputsSkipTime:L.at(-1)}))}}),H=m("button","apply",{className:"btn mt-8"}),U=m("button","cancel",{className:"btn mt-8"}),ue=new j({inputsLoopTime:{inputLoopStartMin:R,inputLoopStartSec:q,inputLoopEndMin:F,inputLoopEndSec:Z}});k(y,[m("div","loop time video",{className:"mb-6"}),ue,m("hr"),m("div","skip time video",{className:"mb-6"}),h,ae,H,U]);let I=!0;const se=()=>{y.classList.add("close"),setTimeout(()=>{_(N,y),y.classList.remove("close")},100),I=!0},J=oe(re,"settings");J.onclick=()=>{I?(v(N,y),I=!1):se()},v(N,J),(async()=>{let t=0,e=0;const n=[];let o=0,r=0,i=!1,a=await B("#ytd-player");const u=await B(".item.style-scope.ytd-watch-metadata");v(u,N);function s(c){c===M.Playing&&(r=setInterval(()=>{(e&&o>=e||o<t)&&(clearInterval(r),a.player_.seekTo(t)),n.forEach(l=>{l.timeSkipEnd&&o>=l.timeSkipStart&&o<l.timeSkipEnd&&(clearInterval(r),a.player_.seekTo(l.timeSkipEnd))}),o=a.player_.getCurrentTime()},1e3)),(c==M.Paused||c==M.Buffering||c==M.Ended)&&clearInterval(r)}H.onclick=()=>{t=Number(R.value)*60+Number(q.value),e=Number(F.value)*60+Number(Z.value),L.forEach(c=>{n.push({timeSkipStart:Number(c.inputSkipStartMin.value)*60+Number(c.inputSkipStartSec.value),timeSkipEnd:Number(c.inputSkipEndMin.value)*60+Number(c.inputSkipEndSec.value)})}),i||(s(M.Playing),setTimeout(()=>{a.player_.addEventListener("onStateChange",s)},1e3),i=!0)},U.onclick=()=>{clearInterval(r),a.player_.removeEventListener("onStateChange",s),i=!1}})()})();
